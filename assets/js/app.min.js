function selectLastlySelectedTab(a){a=a||"",$(a+" [data-toggle='ajax-tab']").each(function(){var a=$(this).attr("id"),t=getCookie("user_"+AppHelper.userId+"_"+a),e=$(this).find("[data-target='"+t+"']");t&&e.attr("data-target")?setTimeout(function(){e.trigger("click")},200):$(this).find("a").first().trigger("click")})}$(document).ready(function(){$.ajaxSetup({cache:!1}),moment.locale(AppLanugage.locale),jQuery.fn.datepicker.dates.custom={days:AppLanugage.days,daysShort:AppLanugage.daysShort,daysMin:AppLanugage.daysMin,months:AppLanugage.months,monthsShort:AppLanugage.monthsShort,today:AppLanugage.today},$("body").on("click","[data-act=ajax-modal]",function(){var t={ajaxModal:1},a=$(this).attr("data-action-url"),e=$(this).attr("data-modal-lg"),n=$(this).attr("data-title");return a?(n?$("#ajaxModalTitle").html(n):$("#ajaxModalTitle").html($("#ajaxModalTitle").attr("data-title")),$(this).attr("data-post-hide-header")?($("#ajaxModal .modal-header").addClass("hide"),$("#ajaxModal .modal-footer").addClass("hide")):($("#ajaxModal .modal-header").removeClass("hide"),$("#ajaxModal .modal-footer").removeClass("hide")),$("#ajaxModalContent").html($("#ajaxModalOriginalContent").html()),$("#ajaxModalContent").find(".original-modal-body").removeClass("original-modal-body").addClass("modal-body"),$("#ajaxModal").modal("show"),$(this).each(function(){$.each(this.attributes,function(){if(this.specified&&this.name.match("^data-post-")){var a=this.name.replace("data-post-","");t[a]=this.value}})}),ajaxModalXhr=$.ajax({url:a,data:t,cache:!1,type:"POST",success:function(a){$("#ajaxModal").find(".modal-dialog").removeClass("mini-modal"),"1"===e&&$("#ajaxModal").find(".modal-dialog").addClass("modal-lg"),$("#ajaxModalContent").html(a),setSummernoteToAll(!0),setTimeout(function(){setModalScrollbar()},400)},statusCode:{404:function(){$("#ajaxModalContent").find(".modal-body").html(""),appAlert.error("404: Page not found.",{container:".modal-body",animate:!1})}},error:function(){$("#ajaxModalContent").find(".modal-body").html(""),appAlert.error("500: Internal Server Error.",{container:".modal-body",animate:!1})}})):console.log("Ajax Modal: Set data-action-url!"),!1}),$("#ajaxModal").on("hidden.bs.modal",function(a){ajaxModalXhr.abort(),$("#ajaxModal").find(".modal-dialog").removeClass("modal-lg"),$("#ajaxModal").find(".modal-dialog").addClass("mini-modal"),$("#ajaxModalContent").html("")}),$("body").on("click","[data-act=ajax-request]",function(){var t={},a=$(this),e=a.attr("data-action-url"),n=a.attr("data-remove-on-success"),o=a.attr("data-remove-on-click"),r=a.attr("data-fade-out-on-success"),i=a.attr("data-fade-out-on-click"),s=a.attr("data-inline-loader"),l=a.attr("data-reload-on-success"),d="";if(a.attr("data-real-target")?d=$(a.attr("data-real-target")):a.attr("data-closest-target")&&(d=a.closest(a.attr("data-closest-target"))),!e)return console.log("Ajax Request: Set data-action-url!"),!1;o&&$(o).length&&$(o).remove(),i&&$(i).length&&$(i).fadeOut(function(){$(this).remove()}),a.each(function(){$.each(this.attributes,function(){if(this.specified&&this.name.match("^data-post-")){var a=this.name.replace("data-post-","");t[a]=this.value}})}),"1"===s?a.addClass("inline-loader"):appLoader.show(),ajaxRequestXhr=$.ajax({url:e,data:t,cache:!1,type:"POST",success:function(a){l&&location.reload(),n&&$(n).length&&$(n).remove(),r&&$(r).length&&$(r).fadeOut(function(){$(this).remove()}),appLoader.hide(),d.length&&d.html(a)},statusCode:{404:function(){appLoader.hide(),appAlert.error("404: Page not found.")}},error:function(){appLoader.hide(),appAlert.error("500: Internal Server Error.")}})}),$("body").on("click",'[data-toggle="ajax-tab"] a',function(){var a=$(this),t=a.attr("href"),e=a.attr("data-target");return e&&(""===$(e).html()&&(appLoader.show({container:e,css:"right:50%; bottom:auto;"}),$.get(t,function(a){$(e).html(a),selectLastlySelectedTab(e)})),a.tab("show")),!1}),selectLastlySelectedTab(),$("body").on("click",'[data-toggle="app-modal"]',function(){var a=!0;return"0"===$(this).attr("data-sidebar")&&(a=!1),appContentModal.init({url:$(this).attr("data-url"),sidebar:a}),!1});function t(a,t){var e=t.attr("data-success-callback");e&&void 0!==window[e]&&(window[e](a,t),a.message&&appAlert.warning(a.message,{duration:2e4}))}$("body").on("click","a[data-action=delete-confirmation]:not(table a)",function(a){deleteConfirmationHandler(a,t)})}),function(s){s.fn.appForm=function(a){var o=s.extend({},{ajaxSubmit:!0,isModal:!0,closeModalOnSuccess:!0,dataType:"json",onModalClose:function(){},onSuccess:function(){},onError:function(){return!0},onSubmit:function(){},onAjaxSuccess:function(){},beforeAjaxSubmit:function(a,t,e){}},a);function i(a){if(a){var t,e=(t=(t=AppHelper.settings.dateFormat||"Y.m.d").toLowerCase()).charAt("1"),n=t.split(e),o=0,r=1,i=2;"y"===n[1]?o=1:"y"===n[2]&&(o=2),"m"===n[0]?r=0:"m"===n[2]&&(r=2),"d"===n[0]?i=0:"d"===n[1]&&(i=1);var s=a.split(e);return s[o]+"-"+s[r]+"-"+s[i]}}function t(a,t){s.validator.addMethod("greaterThanOrEqual",function(a,t,e){var n=e;return!e||0!==e.indexOf("#")&&0!==e.indexOf(".")||(n=s(e).val()),/Invalid|NaN/.test(new Date(a))?isNaN(a)&&isNaN(n)||Number(a)>=Number(n):new Date(i(a))>=new Date(i(n))},"Must be greater than {0}."),s.validator.addMethod("greaterThan",function(a,t,e){var n=e;return!e||0!==e.indexOf("#")&&0!==e.indexOf(".")||(n=s(e).val()),/Invalid|NaN/.test(new Number(a))?isNaN(a)&&isNaN(n)||Number(a)>Number(n):new Number(a)>new Number(n)},"Must be greater than."),s.validator.addMethod("mustBeSameYear",function(a,t,e){var n=e;if(!e||0!==e.indexOf("#")&&0!==e.indexOf(".")||(n=s(e).val()),!/Invalid|NaN/.test(new Date(i(a)))){var o=new Date(i(a)),r=new Date(i(n));return o&&r&&o.getFullYear()===r.getFullYear()}},"The year must be same for both dates."),s(a).validate({submitHandler:function(a){if(!t)return!0;t(a)},highlight:function(a){s(a).closest(".form-group").addClass("has-error")},unhighlight:function(a){s(a).closest(".form-group").removeClass("has-error")},errorElement:"span",errorClass:"help-block",ignore:":hidden:not(.validate-hidden)",errorPlacement:function(a,t){t.parent(".input-group").length?a.insertAfter(t.parent()):a.insertAfter(t)}}),s(".validate-hidden").click(function(){s(this).closest(".form-group").removeClass("has-error").find(".help-block").hide()})}function e(a){a&&(s(".modal-mask").html("<div class='circle-done'><i class='fa fa-check'></i></div>"),setTimeout(function(){s(".modal-mask").find(".circle-done").addClass("ok")},30)),setTimeout(function(){s(".modal-mask").remove(),s("#ajaxModal").modal("toggle"),o.onModalClose()},1e3)}return this.each(function(){o.ajaxSubmit?t(s(this),function(n){o.onSubmit(),o.isModal?function(a){var t=a.height()-80;0<t&&(t=Math.floor(t/2));a.after("<div class='modal-mask'><div class='circle-loader'></div></div>");var e=a.outerHeight();s(".modal-mask").css({width:a.width()+22+"px",height:e+"px","padding-top":t+"px"}),a.closest(".modal-dialog").find('[type="submit"]').attr("disabled","disabled"),a.addClass("hide")}(s("#ajaxModalContent").find(".modal-body")):s(n).find('[type="submit"]').attr("disabled","disabled"),"1"===AppHelper.settings.enableRichTextEditor&&s("textarea").each(function(){var a=s(this);!a.attr("data-rich-text-editor")||"<p><br></p>"!==a.val()&&""!==a.val()||a.val("")}),s(n).ajaxSubmit({dataType:o.dataType,beforeSubmit:function(e,a,t){s.each(e,function(a,t){t.data&&t.data.convertDateFormat&&t.value&&(e[a].value=i(t.value))}),o.isModal||appLoader.show({container:n,css:"top:2%; right:46%;"}),o.beforeAjaxSubmit(e,a,t)},success:function(a){var t;o.onAjaxSuccess(a),a.success?(o.onSuccess(a),o.isModal&&o.closeModalOnSuccess&&e(!0),o.isModal||s(n).find("textarea").each(function(){s(this).attr("data-rich-text-editor")&&s(this).summernote("destroy")}),appLoader.hide()):o.onError(a)&&(o.isModal?((t=s(".modal-body").removeClass("hide")).closest(".modal-dialog").find('[type="submit"]').removeAttr("disabled"),t.removeClass("hide"),s(".modal-mask").remove(),a.message&&appAlert.error(a.message,{container:".modal-body",animate:!1})):a.message&&appAlert.error(a.message)),s(n).find('[type="submit"]').removeAttr("disabled")}})}):t(s(this))}),this.closeModal=function(){e(!0)},this}}(jQuery);var getWeekRange=function(a){a=a||moment().format("YYYY-MM-DD");var t=moment(a).format("E")-AppHelper.settings.firstDayOfWeek,e={};return e.firstDateOfWeek=t<7?moment(a).subtract(t,"days").format("YYYY-MM-DD"):moment(a).format("YYYY-MM-DD"),t<0&&(e.firstDateOfWeek=moment(e.firstDateOfWeek).subtract(7,"days").format("YYYY-MM-DD")),e.lastDateOfWeek=moment(e.firstDateOfWeek).add(6,"days").format("YYYY-MM-DD"),e},prepareDefaultFilters=function(a){var t,e,n,o,r,i,s,l;return a=function(a){if("daily"===a.dateRangeType)a.filterParams.start_date=moment().format(a._inputDateFormat),a.filterParams.end_date=a.filterParams.start_date;else if("monthly"===a.dateRangeType){var t=moment().daysInMonth(),e=moment().format("YYYY-MM");a.filterParams.start_date=e+"-01",a.filterParams.end_date=e+"-"+t}else if("yearly"===a.dateRangeType){var n=moment().format("YYYY");a.filterParams.start_date=n+"-01-01",a.filterParams.end_date=n+"-12-31"}else if("weekly"===a.dateRangeType){var o=getWeekRange();a.filterParams.start_date=o.firstDateOfWeek,a.filterParams.end_date=o.lastDateOfWeek}return a}(a),t=a,e=[],n="",$.each(t.checkBoxes,function(a,t){n=t.name,t.isChecked&&e.push(t.value)}),t.filterParams[n]=e,o=a=t,$.each(o.multiSelect,function(a,t){var e=[];$.each(t.options,function(a,t){t.isChecked&&e.push(t.value)}),o.filterParams[t.name]=e}),r=a=o,$.each(r.radioButtons,function(a,t){t.isChecked&&(r.filterParams[t.name]=t.value)}),i=a=r,$.each(i.filterDropdown||[],function(a,e){$.each(e.options,function(a,t){t.isSelected&&(i.filterParams[e.name]=t.id)})}),s=a=i,$.each(s.singleDatepicker||[],function(a,e){$.each(e.options||[],function(a,t){t.isSelected&&(s.filterParams[e.name]=t.value)})}),l=a=s,$.each(l.rangeDatepicker||[],function(a,t){t.startDate&&t.startDate.value&&(l.filterParams[t.startDate.name]=t.startDate.value),t.startDate&&t.endDate.value&&(l.filterParams[t.endDate.name]=t.endDate.value)}),a=l},buildFilterDom=function(u,m,p){function f(a,t){a.is("table")?a.appTable({reload:!0,filterParams:t.filterParams}):a.appFilters({reload:!0,filterParams:t.filterParams})}if(u.search&&!1!==u.search.show){var t,a='<div class="DTTT_container"><input type="search" class="custom-filter-search" name="'+u.search.name+'" placeholder="'+u.customLanguage.searchPlaceholder+'"></div>';m.find(".custom-toolbar").append(a),m.find(".custom-filter-search").keyup(function(){appLoader.show();var a=$(this);clearTimeout(t),t=setTimeout(function(){u.filterParams[u.search.name]=a.val(),f(p,u)},700)})}if(u.isMobile&&(m.find(".custom-toolbar").addClass("clearfix"),u.dateRangeType||void 0!==u.checkBoxes[0]||void 0!==u.multiSelect[0]||void 0!==u.radioButtons[0]||void 0!==u.singleDatepicker[0]||void 0!==u.rangeDatepicker[0]||void 0!==u.filterDropdown[0])){var e="<div class='pull-right'>                        <button title='"+AppLanugage.filters+"' class='dropdown-toggle btn btn-default mt0' data-toggle='collapse' data-target='#table-collapse-filter' aria-expanded='false'><i class='fa fa-sliders'></i></button>                    </div>                    <div id='table-collapse-filter' class='navbar-collapse collapse w100p'></div>";m.find(".custom-toolbar").append(e)}u.reloadSelector&&$(u.reloadSelector).length&&$(u.reloadSelector).click(function(){appLoader.show(),f(p,u)});function h(a){u.isMobile?m.find("#table-collapse-filter").append(a):m.find(".custom-toolbar").append(a)}if(u.dateRangeType){h('<div class="mr15 DTTT_container"><button data-act="prev" class="btn btn-default date-range-selector"><i class="fa fa-chevron-left"></i></button><button data-act="datepicker" class="btn btn-default" style="margin: -1px"></button><button data-act="next"  class="btn btn-default date-range-selector"><i class="fa fa-chevron-right"></i></button></div>');var s=m.find("[data-act='datepicker']"),n=m.find(".date-range-selector");if("daily"===u.dateRangeType){function o(a){u.filterParams.start_date===moment().format(u._inputDateFormat)?a.html(u.customLanguage.today):u.filterParams.start_date===moment().subtract(1,"days").format(u._inputDateFormat)?a.html(u.customLanguage.yesterday):u.filterParams.start_date===moment().add(1,"days").format(u._inputDateFormat)?a.html(u.customLanguage.tomorrow):a.html(moment(u.filterParams.start_date).format("Do MMMM YYYY"))}o(s),s.datepicker({format:u._inputDateFormat,autoclose:!0,todayHighlight:!0,language:"custom"}).on("changeDate",function(a){var t=moment(a.date).format(u._inputDateFormat);u.filterParams.start_date=t,u.filterParams.end_date=t,o(s),f(p,u)}),n.click(function(){var a=$(this).attr("data-act"),t="";"next"===a?t=moment(u.filterParams.start_date).add(1,"days").format(u._inputDateFormat):"prev"===a&&(t=moment(u.filterParams.start_date).subtract(1,"days").format(u._inputDateFormat)),u.filterParams.start_date=t,u.filterParams.end_date=t,o(s),f(p,u)})}if("monthly"===u.dateRangeType){function l(a){a.html(moment(u.filterParams.start_date).format("MMMM YYYY"))}l(s),s.datepicker({format:"YYYY-MM",viewMode:"months",minViewMode:"months",autoclose:!0,language:"custom"}).on("changeDate",function(a){var t=moment(a.date).format(u._inputDateFormat),e=moment(t).daysInMonth(),n=moment(t).format("YYYY-MM");u.filterParams.start_date=n+"-01",u.filterParams.end_date=n+"-"+e,l(s),f(p,u)}),n.click(function(){var a=$(this).attr("data-act"),t=moment(u.filterParams.start_date),e=moment(u.filterParams.end_date);if("next"===a){var n=t.add(1,"months"),o=n.daysInMonth();t=(r=n.format("YYYY-MM"))+"-01",e=r+"-"+o}else if("prev"===a){var r,i=t.subtract(1,"months");o=i.daysInMonth();t=(r=i.format("YYYY-MM"))+"-01",e=r+"-"+o}u.filterParams.start_date=t,u.filterParams.end_date=e,l(s),f(p,u)})}if("yearly"===u.dateRangeType){function r(a){a.html(moment(u.filterParams.start_date).format("YYYY"))}r(s),s.datepicker({format:"YYYY-MM",viewMode:"years",minViewMode:"years",autoclose:!0,language:"custom"}).on("changeDate",function(a){var t=moment(a.date).format(u._inputDateFormat),e=moment(t).format("YYYY");u.filterParams.start_date=e+"-01-01",u.filterParams.end_date=e+"-12-31",r(s),f(p,u)}),n.click(function(){var a=$(this).attr("data-act"),t=moment(u.filterParams.start_date),e=moment(u.filterParams.end_date);"next"===a?(t=t.add(1,"years").format(u._inputDateFormat),e=e.add(1,"years").format(u._inputDateFormat)):"prev"===a&&(t=t.subtract(1,"years").format(u._inputDateFormat),e=e.subtract(1,"years").format(u._inputDateFormat)),u.filterParams.start_date=t,u.filterParams.end_date=e,r(s),f(p,u)})}if("weekly"===u.dateRangeType){function i(a){var t=moment(u.filterParams.start_date).format("Do MMM"),e=moment(u.filterParams.end_date).format("Do MMM, YYYY");s.datepicker({format:"YYYY-MM-DD",autoclose:!0,calendarWeeks:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek}),a.html(t+" - "+e)}i(s),n.click(function(){var a=$(this).attr("data-act"),t=moment(u.filterParams.start_date),e=moment(u.filterParams.end_date);"next"===a?(t=t.add(7,"days").format(u._inputDateFormat),e=e.add(7,"days").format(u._inputDateFormat)):"prev"===a&&(t=t.subtract(7,"days").format(u._inputDateFormat),e=e.subtract(7,"days").format(u._inputDateFormat)),u.filterParams.start_date=t,u.filterParams.end_date=e,i(s),f(p,u)}),s.datepicker({format:u._inputDateFormat,autoclose:!0,calendarWeeks:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek}).on("show",function(){$(".datepicker").addClass("week-view"),$(".datepicker-days").find(".active").siblings(".day").addClass("active")}).on("changeDate",function(a){var t=getWeekRange(a.date);u.filterParams.start_date=t.firstDateOfWeek,u.filterParams.end_date=t.lastDateOfWeek,i(s),f(p,u)})}}if(void 0!==u.checkBoxes[0]){var d="",c=[],g="";$.each(u.checkBoxes,function(a,t){var e="",n="";g=t.name,t.isChecked&&(e=" checked",n=" active",c.push(t.value)),d+='<label class="btn btn-default '+n+'">',d+='<input type="checkbox" name="'+t.name+'" value="'+t.value+'" autocomplete="off" '+e+">"+t.text,d+="</label>"}),u.filterParams[g]=c,h('<div class="mr15 DTTT_container"><div class="btn-group filter" data-act="checkbox" data-toggle="buttons">'+d+"</div></div>"),m.find("[data-act='checkbox']").click(function(){var e=$(this);setTimeout(function(){var a=[],t="";e.parent().find("input:checkbox").each(function(){t=$(this).attr("name"),$(this).is(":checked")&&a.push($(this).val())}),u.filterParams[t]=a,f(p,u)})})}if(void 0!==u.multiSelect[0]&&$.each(u.multiSelect,function(a,n){var o="",r=[];$.each(n.options,function(a,t){var e="";t.isChecked&&(e=" active",r.push(t.value)),o+='<li class="list-group-item clickable '+e+'" data-name="'+n.name+'" data-value="'+t.value+'">',o+=t.text,o+="</li>"}),o="<ul class='list-group dropdown-menu' data-act='multiselect'>"+o+"</ul>",u.filterParams[n.name]=r;var t='<div class="mr15 DTTT_container"><span class="dropdown inline-block filter-multi-select"><button class="btn btn-default dropdown-toggle " type="button" data-toggle="dropdown" aria-expanded="true">'+n.text+' <span class="caret"></span> </button>'+o+"</span></div>";h(t),m.find("[data-name='"+n.name+"']").click(function(){var e=$(this);return e.toggleClass("active"),setTimeout(function(){var a=[],t="";e.parent().find("li").each(function(){t=$(this).attr("data-name"),$(this).hasClass("active")&&a.push($(this).attr("data-value"))}),u.filterParams[t]=a,f(p,u)}),!1})}),void 0!==u.radioButtons[0]){var v="";$.each(u.radioButtons,function(a,t){var e="",n="";t.isChecked&&(e=" checked",n=" active",u.filterParams[t.name]=t.value),v+='<label class="btn btn-default '+n+'">',v+='<input type="radio" name="'+t.name+'" value="'+t.value+'" autocomplete="off" '+e+">"+t.text,v+="</label>"}),h('<div class="mr15 DTTT_container"><div class="btn-group filter" data-act="radio" data-toggle="buttons">'+v+"</div></div>"),m.find("[data-act='radio']").click(function(){var a=$(this);setTimeout(function(){a.parent().find("input:radio").each(function(){$(this).is(":checked")&&(u.filterParams[$(this).attr("name")]=$(this).val())}),f(p,u)})})}if(void 0!==u.singleDatepicker[0]&&$.each(u.singleDatepicker,function(a,t){var n=" ",o="",r="";t.options||(t.options=[]),t.options.push({value:"show-date-picker",text:AppLanugage.custom}),$.each(t.options,function(a,t){var e="";t.isSelected&&(e="active",o=t.value,r=t.text),n+='<div class="list-group-item '+e+'" data-value="'+t.value+'">'+t.text+"</div>"}),r||(r="- "+t.defaultText+" -",n='<div class="list-group-item active" data-value="">'+r+"</div>"+n),t.name&&(u.filterParams[t.name]=o);function e(a){u.filterParams[t.name]=a,f(p,u)}function i(a){return a+"<i class='ml10 fa fa-caret-down text-off'></i>"}var s='<div class="datepicker-custom-list list-group mb0">'+n+"</div>",l='<div class="mr15 DTTT_container"><button name="'+t.name+'" class="btn datepicker-custom-selector">'+i(r)+"</button></div>";h(l);var d=m.find("[name='"+t.name+"']"),c=void 0!==t.options[1];d.datepicker({format:u._inputDateFormat,autoclose:!0,todayHighlight:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek,orientation:"bottom"}).on("show",function(){c&&($(".datepicker-days, .datepicker-months, .datepicker-years, .datepicker-decades, .table-condensed").hide(),$(".datepicker-custom-list").show(),$(".datepicker-custom-list").length||($(".datepicker").append(s),$(".datepicker .list-group-item").click(function(){$(".datepicker .list-group-item").removeClass("active"),$(this).addClass("active");var a=$(this).attr("data-value");"show-date-picker"===a?($(".datepicker-custom-list, .datepicker-months, .datepicker-years, .datepicker-decades, .table-condensed").hide(),$(".datepicker-days, .table-condensed").show()):($(".datepicker").hide(),moment(a,u._inputDateFormat).isValid()&&(a=moment(a,u._inputDateFormat).format(u._inputDateFormat)),d.html(i($(this).html())),e(a))})))}).on("changeDate",function(a){d.html(i(moment(a.date,u._inputDateFormat).format("Do MMMM YYYY"))),e(moment(a.date,u._inputDateFormat).format(u._inputDateFormat))})}),void 0!==u.rangeDatepicker[0]&&$.each(u.rangeDatepicker,function(a,t){var e=t.startDate||{},n=t.endDate||{},o=!!t.showClearButton,r='<i class="fa fa-calendar"></i>',i=e.value?moment(e.value,u._inputDateFormat).format("Do MMMM YYYY"):r,s=n.value?moment(n.value,u._inputDateFormat).format("Do MMMM YYYY"):r;u.filterParams[e.name]=e.value,u.filterParams[n.name]=n.value;function l(a,t){u.filterParams[a]=t,f(p,u)}h('<div class="mr15 DTTT_container"><div class="input-daterange input-group"><button class="btn btn-default form-control" name="'+e.name+'" data-date="'+e.value+'">'+i+'</button><span class="input-group-addon">-</span><button class="btn btn-default form-control" name="'+n.name+'" data-date="'+n.value+'">'+s+"</div></div>");var d=m.find(".input-daterange"),c=d.find("button").toArray();d.datepicker({format:"yyyy-mm-dd",autoclose:!0,todayHighlight:!0,language:"custom",weekStart:AppHelper.settings.firstDayOfWeek,orientation:"bottom",inputs:c}).on("changeDate",function(a){var t=moment(a.date,u._inputDateFormat).format(u._inputDateFormat);u.filterParams[e.name]||(u.filterParams[e.name]=t),u.filterParams[n.name]||(u.filterParams[n.name]=t),l($(a.target).attr("name"),t),$(c[0]).html(moment(u.filterParams[e.name],u._inputDateFormat).format("Do MMMM YYYY")),$(c[1]).html(moment(u.filterParams[n.name],u._inputDateFormat).format("Do MMMM YYYY"))}).on("show",function(){o&&($(".datepicker-clear-selection").show(),$(".datepicker-clear-selection").length||($(".datepicker").append("<div class='datepicker-clear-selection p5 clickable text-center'>"+AppLanugage.clear+"</div>"),$(".datepicker .datepicker-clear-selection").click(function(){u.filterParams[e.name]="",l(n.name,""),$(c[0]).html(r),$(c[1]).html(r),$(".datepicker").hide()})))})}),void 0!==u.filterDropdown[0]){v="";$.each(u.filterDropdown,function(a,n){var o="",r="";$.each(n.options,function(a,t){var e="";t.isSelected&&(e="selected",r=t.id),o+="<option "+e+' value="'+t.id+'">'+t.text+"</option>"}),n.name&&(u.filterParams[n.name]=r);var t='<div class="mr15 DTTT_container"><select class="'+n.class+'" name="'+n.name+'">'+o+"</select></div>";h(t);var e=m.find("[name='"+n.name+"']");void 0!==window.Select2&&e.select2(),e.change(function(){var a=$(this),t=a.attr("name"),e=a.val();u.filterParams[t]=e,n.dependent&&n.dependent.length&&b(t,e,u.filterDropdown,m,u.filterParams),f(p,u)})})}var b=function(n,r,a,i,s){$.each(a,function(a,t){if(t.dependency&&t.dependency.length&&-1!==t.dependency.indexOf(n)){var o=i.find("select[name="+t.name+"]");if((t.selfDependency&&!r||r)&&t.dataSource)$.ajax({url:t.dataSource,data:s,type:"POST",dataType:"json",success:function(a){if(a&&a.length){var e="",n="";$.each(a,function(a,t){a||(n=t.id),e+="<option value='"+t.id+"'>"+t.text+"</option>"}),o.html(e),o.select2("val",n)}}});else{var e=o.find("option:first");o.html("<option value='"+e.val()+"'>"+e.html()+"</option>"),o.select2("val",e.val())}e=o.find("option:first");s[t.name]=e.val()}})}};function encodeAjaxPostData(a){return a=replaceAll("=","~",a),a=replaceAll("&","^",a)}function replaceAll(a,t,e){return e.replace(new RegExp(a,"g"),t)}"undefined"!=typeof TableTools&&(TableTools.DEFAULTS.sSwfPath=AppHelper.assetsDirectory+"js/datatable/TableTools/swf/copy_csv_xls_pdf.swf"),function(g){g.fn.appTable=function(a){var t=+AppHelper.settings.displayLength;!isNaN(t)&&t||(t=10);var e={source:"",xlsColumns:[],pdfColumns:[],printColumns:[],columns:[],order:[[0,"asc"]],hideTools:!1,displayLength:t,dateRangeType:"",checkBoxes:[],multiSelect:[],radioButtons:[],filterDropdown:[],singleDatepicker:[],rangeDatepicker:[],stateSave:!0,isMobile:window.outerWidth<800,responsive:"1"!==AppHelper.settings.disableResponsiveDataTableForMobile&&window.outerWidth<800,stateDuration:5184e3,columnShowHideOption:!0,tableRefreshButton:!1,filterParams:{datatable:!0},onDeleteSuccess:function(){},onUndoSuccess:function(){},onInitComplete:function(){},customLanguage:{noRecordFoundText:AppLanugage.noRecordFound,searchPlaceholder:AppLanugage.search,printButtonText:AppLanugage.print,excelButtonText:AppLanugage.excel,printButtonToolTip:AppLanugage.printButtonTooltip,today:AppLanugage.today,yesterday:AppLanugage.yesterday,tomorrow:AppLanugage.tomorrow},footerCallback:function(a,t,e,n,o){},rowCallback:function(a,t,e,n){},summation:"",onRelaodCallback:function(){}},d=g(this);if(!d.is("table"))return console.log("appTable: Element must have to be a table",this),!1;var c=g.extend({},e,a);if(c.reload){var u=g(this).dataTable(),n=window.InstanceCollection[g(this).selector];return n=n||c,u.fnReloadAjax(n.filterParams),g(this).data("onRelaodCallback")&&g(this).data("onRelaodCallback")(u,n.filterParams),!1}if(c.newData){u=g(this).dataTable();if(c.dataId){var o=g(this).find("[data-post-id='"+c.dataId+"']");o.length||(o=g(this).find("[data-index-id='"+c.dataId+"']")),o.length?(u.api().row(u.api().row(o.closest("tr")).index()).data(c.newData),u.fnUpdateRow(null,u.api().page())):u.fnUpdateRow(c.newData)}else c.rowDeleted?u.fnUpdateRow(c.newData,u.api().page(),!0):u.fnUpdateRow(c.newData);return!1}c.responsive&&d.addClass("nowrap");function r(o,r,i){var s="",a="";return"all"===r&&(a='data-section="all_pages"'),s+="<tr "+a+">",g.each(o.columns,function(e,a){var n="class = 'tf-blank' ",t=" ";o.summation[0]&&o.summation[0].column-1===e&&(t=i,n="class = 'tf-lable' "),g.each(o.summation,function(a,t){t.column===e&&(n="class = 'tf-result text-right' ",n+="data-"+r+'-page="'+t.column+'"')}),s+="<th "+n+">",s+=t,s+="</th>"}),s+="</tr>"}if(c.summation&&c.summation.length&&!c.isMobile){var i="<tfoot>";i+=r(c,"current",AppLanugage.total),i+=r(c,"all",AppLanugage.totalOfAllPages),i+="</tfoot>",d.html(i)}c._visible_columns=[],g.each(c.columns,function(a,t){!1!==t.visible&&c._visible_columns.push(a)}),c._exportable=c.xlsColumns.length+c.pdfColumns.length+c.printColumns.length,c._firstDayOfWeek=AppHelper.settings.firstDayOfWeek||0,c._inputDateFormat="YYYY-MM-DD";var s={ajax:{url:(c=prepareDefaultFilters(c)).source,type:"POST",data:c.filterParams},sServerMethod:"POST",columns:c.columns,bProcessing:!0,iDisplayLength:c.displayLength,aLengthMenu:[[10,25,50,100,-1],[10,25,50,100,AppLanugage.all]],bAutoWidth:!1,bSortClasses:!1,order:c.order,stateSave:c.stateSave,responsive:c.responsive,fnStateLoadParams:function(a,t){t&&t.search&&(t.search.search="")},stateDuration:c.stateDuration,fnInitComplete:function(){c.onInitComplete(this)},language:{lengthMenu:"_MENU_",zeroRecords:c.customLanguage.noRecordFoundText,info:"_START_-_END_ / _TOTAL_",sInfo:"_START_-_END_ / _TOTAL_",infoFiltered:"(_MAX_)",search:"",searchPlaceholder:c.customLanguage.searchPlaceholder,sInfoEmpty:"0-0 / 0",sInfoFiltered:"(_MAX_)",sInfoPostFix:"",sInfoThousands:",",sProcessing:"<div class='table-loader'><span class='loading'></span></div>",oPaginate:{sPrevious:"<i class='fa fa-angle-double-left'></i>",sNext:"<i class='fa fa-angle-double-right'></i>"}},sDom:"",footerCallback:function(a,t,e,n,o){var i=this;if(c.summation){var s=i.api().page.info(),r="",l="",d="";if(!s.recordsTotal)return g(i).find("tfoot").hide(),!1;g(i).find("tfoot").show(),g.each(c.summation,function(a,t){var e=calculateDatatableTotal(i,t.column,function(a){return a&&!a.startsWith("<b>")?"currency"===t.dataType?unformatCurrency(a):"time"===t.dataType?moment.duration(a).asSeconds():"number"===t.dataType?unformatCurrency(a):a:0},!0);"currency"===t.dataType?e=toCurrency(e,t.currencySymbol):"time"===t.dataType?e=secondsToTimeFormat(e):"number"===t.dataType&&(e=toCurrency(e,"none"));var n=u.column(t.column).header();if(n&&(l+="<div class='box'><div class='box-content'>"+g(n).html()+"</div><div class='box-content text-right'>"+e+"</div></div>"),g(i).find("[data-current-page="+t.column+"]").html(e),1<s.pages){g(i).find("[data-section='all_pages']").show();var o=calculateDatatableTotal(i,t.column,function(a){return a&&!a.startsWith("<b>")?"currency"===t.dataType?unformatCurrency(a):"time"===t.dataType?moment.duration(a).asSeconds():"number"===t.dataType?unformatCurrency(a):a:0});"currency"===t.dataType?o=toCurrency(o,t.currencySymbol):"time"===t.dataType?o=secondsToTimeFormat(o):"number"===t.dataType&&(o=toCurrency(o,"none"));var r=u.column(t.column).header();r&&(d+="<div class='box'><div class='box-content'>"+g(r).html()+"</div><div class='box-content text-right'>"+o+"</div></div>"),g(i).find("[data-all-page="+t.column+"]").html(o)}else g(i).find("[data-section='all_pages']").hide()}),c.isMobile&&(l&&(r+="<div class='box'><div class='box-content strong'>"+AppLanugage.total+"</div></div>"+l),d&&(r+="<div class='box'><div class='box-content strong'>"+AppLanugage.totalOfAllPages+"</div></div>"+d),g(".summation-section").html(r))}c.footerCallback(a,t,e,n,o,i)},fnRowCallback:function(a,t,e,n){c.rowCallback(a,t,e,n)}};if(AppHelper.userId&&(s.stateSaveParams=function(a,t){-1===a.sInstance.indexOf("-user-ref-")&&(a.sInstance+="-user-ref-"+AppHelper.userId)},s.stateLoadCallback=function(a){-1===a.sInstance.indexOf("-user-ref-")&&(a.sInstance+="-user-ref-"+AppHelper.userId);try{return JSON.parse((-1===a.iStateDuration?sessionStorage:localStorage).getItem("DataTables_"+a.sInstance+"_"+location.pathname))}catch(a){}}),c.hideTools||(s.sDom="<'datatable-tools'<'col-md-2 toolbar-left-top'l><'col-md-10 custom-toolbar'f>r>t<'datatable-tools clearfix'<'col-md-3'i><'col-md-9'p>>"),c._exportable){var l=[];c.xlsColumns.length&&l.push({extend:"excelHtml5",footer:!0,text:c.customLanguage.excelButtonText,exportOptions:{columns:":visible:not(.option)"},customize:function(a){if(d.find("[data-section='all_pages']")&&"none"!==d.find("[data-section='all_pages']").css("display")){var t=a.xl.worksheets["sheet1.xml"],e=g(t.childNodes[0].childNodes[1]),n=parseInt(e.find("row:last-child").attr("r"))+1,o=0,r='<row r="'+n+'">';d.find("[data-section='all_pages'] th").each(function(){g(this).text()&&(r+='<c t="inlineStr" r="'+"abcdefghijklmnopqrstuvwxyz"[o].toUpperCase()+n+'" s="2">',r+="<is>",r+="<t>"+g(this).text()+"</t>",r+="</is>",r+="</c>"),o+=1}),r+="</row>",t.childNodes[0].childNodes[1].innerHTML=t.childNodes[0].childNodes[1].innerHTML+r}}}),c.pdfColumns.length&&l.push({extend:"pdfHtml5",exportOptions:{columns:":visible:not(.option)"}}),c.printColumns.length&&l.push({extend:"print",autoPrint:!1,text:c.customLanguage.printButtonText,footer:!0,exportOptions:{columns:":visible:not(.option)"},customize:function(a){if(g(a.document.body).closest("html").addClass("dt-print-view"),d.find("[data-section='all_pages']")&&"none"!==d.find("[data-section='all_pages']").css("display")){var t=d.find("[data-section='all_pages']").clone();g(a.document.body).find("tfoot").append(t)}},customizeData:function(a,t,e){}}),c.hideTools||(s.sDom="<'datatable-tools'<'col-md-2 toolbar-left-top'l><'col-md-10 custom-toolbar'f<'datatable-export DTTT_container'B>>r>t<'datatable-tools clearfix'<'col-md-3'<'summation-section'> i><'col-md-9'p>>"),s.buttons=l}var m=d.dataTable(s),p=d.closest(".dataTables_wrapper");if(p.find(".DTTT_button_print").tooltip({placement:"bottom",container:"body"}),p.find("select").select2({minimumResultsForSearch:-1}),c.columnShowHideOption){var f=d.attr("id");u=d.DataTable();p.find(".toolbar-left-top").append('<div class="DTTT_container pull-left"><button class="btn btn-default column-show-hide-popover ml15" data-container="body" data-toggle="popover" data-placement="bottom"><i class="fa fa-eye-slash"></button></div>'),p.find(".column-show-hide-popover").popover({html:!0,content:function(){var n="";return g.each(c.columns,function(a,t){if(!1!==t.visible){var e="";u.column(a).visible()||(e="active"),n+="<li class='"+e+" list-group-item clickable toggle-table-column' data-column='"+a+"'>"+t.title+"</li>"}}),"<ul class='list-group' data-table='"+f+"'>"+n+"</ul>"}}),p.find(".column-show-hide-popover").on("shown.bs.popover",function(){g(".toggle-table-column").on("click",function(){var a=g(this).closest(".list-group").attr("data-table"),t=g("#"+a).DataTable().column(g(this).attr("data-column"));t&&(t.visible(!t.visible()),g(this).toggleClass("active"))})})}if(c.tableRefreshButton){p.find(".toolbar-left-top").append('<div class="DTTT_container pull-left "><button class="btn btn-default at-table-refresh-button ml15"><i class="fa fa-refresh"></i></button></div>'),p.find(".at-table-refresh-button").on("click",function(){d.appTable({reload:!0,filterParams:c.filterParams})})}g("body").hasClass("destroy-popover")||(g("body").addClass("destroy-popover"),g(".destroy-popover").on("click",function(a){if("popover"!==g(a.target).closest("button").attr("data-toggle")&&!g(a.target).closest(".popover").length&&!g(a.target).hasClass("editable")){var t=g(".popover.in").attr("id");g("[aria-describedby="+t+"]").trigger("click")}})),d.data("onRelaodCallback",c.onRelaodCallback),buildFilterDom(c,p,d);function h(a,t){var e=t.closest("tr"),n=d.DataTable(),o=t.attr("data-undo"),r=t.attr("data-action-url"),i=t.attr("data-id");m.fnDeleteRow(n.row(e).index(),function(){n.page(n.page()).draw("page")},!1);var s,l=appAlert.warning(a.message,{duration:2e4});c.onDeleteSuccess(a),"0"!==o&&(s={alertSelector:l,url:r,id:i},g('<a class="undo-delete" href="javascript:;"><strong>Undo</strong></a>').insertAfter(g(s.alertSelector).find(".app-alert-message")),g(s.alertSelector).find(".undo-delete").bind("click",function(){g(s.alertSelector).remove(),appLoader.show(),g.ajax({url:s.url,type:"POST",dataType:"json",data:{id:s.id,undo:!0},success:function(a){appLoader.hide(),a.success&&(d.appTable({newData:a.data,rowDeleted:!0}),c.onUndoSuccess(a))}})}))}window.InstanceCollection=window.InstanceCollection||{},window.InstanceCollection[g(this).selector]=c,g("body").find(d).on("click","a[data-action=delete]",function(a){deleteHandler(a,h)}),g("body").find(d).on("click","a[data-action=delete-confirmation]",function(a){deleteConfirmationHandler(a,h)}),g("body").find(d).on("click","[data-action=update]",function(a){appLoader.show();var t=g(a.currentTarget);a.data&&a.data.target&&(t=a.data.target);var e=t.attr("data-action-url");g.ajax({url:e,dataType:"json",success:function(a){a.success?(g(".dataTable:visible").appTable({newData:a.data,dataId:a.id}),appAlert.success(a.message,{duration:1e4})):appAlert.error(a.message),appLoader.hide()}})}),g.fn.dataTableExt.oApi.getSettings=function(a){return a},g.fn.dataTableExt.oApi.fnReloadAjax=function(e,a){this.fnClearTable(this),this.oApi._fnProcessingDisplay(e,!0);var n=this;g.ajax({url:e.ajax.url,type:"POST",dataType:"json",data:a,success:function(a){for(var t=0;t<a.data.length;t++)n.oApi._fnAddData(e,a.data[t]);e.aiDisplay=e.aiDisplayMaster.slice(),n.fnDraw(n),n.oApi._fnProcessingDisplay(e,!1)}})},g.fn.dataTableExt.oApi.fnUpdateRow=function(a,t,e,n){t&&this.oApi._fnAddData(a,t),n&&this.fnDraw(this),e?this.oApi._fnPageChange(a,e,!0):this.fnDraw(this)}}}(jQuery),deleteHandler=function(a,t){appLoader.show();var e=$(a.currentTarget);a.data&&a.data.target&&(e=a.data.target);var n=e.attr("data-action-url"),o=e.attr("data-id"),r=e.attr("data-reload-on-success");$.ajax({url:n,type:"POST",dataType:"json",data:{id:o},success:function(a){a.success?(t&&t(a,e),r&&location.reload()):appAlert.error(a.message),appLoader.hide()}})},deleteConfirmationHandler=function(a,t){var e=$("#confirmDeleteButton"),n=$(a.currentTarget);n.each(function(){$.each(this.attributes,function(){this.specified&&this.name.match("^data-")&&e.attr(this.name,this.value)})}),n.attr("data-undo","0"),e.unbind("click"),e.on("click",{target:n},function(a){deleteHandler(a,t)}),$("#confirmationModal").modal("show")},function(){var a;a=function(n){return t={info:function(a,t){return this._settings=e(t),this._settings.alertType="info",o(a),"#"+this._settings.alertId},success:function(a,t){return this._settings=e(t),this._settings.alertType="success",o(a),"#"+this._settings.alertId},warning:function(a,t){return this._settings=e(t),this._settings.alertType="warning",o(a),"#"+this._settings.alertId},error:function(a,t){return this._settings=e(t),this._settings.alertType="error",o(a),"#"+this._settings.alertId},options:{container:"body",duration:0,showProgressBar:!0,clearAll:!0,animate:!0}};function e(a){if(!a)a={};return a.alertId="app-alert-"+function(){for(var a="",t="abcdefghijklmnopqrstuvwxyz0123456789",e=0;e<5;e++)a+=t.charAt(Math.floor(Math.random()*t.length));return a}(),this._settings=n.extend({},t.options,a)}function o(a){!function(){this._settings.clearAll&&n("[role='alert']").remove()}(),n(this._settings.container).length?(this._settings.animate&&setTimeout(function(){n(".app-alert").animate({opacity:1,right:"40px"},500,function(){n(".app-alert").animate({right:"15px"},300)})},20),n(this._settings.container).prepend(function(a){var t="info";return"error"===this._settings.alertType?t="danger":"success"===this._settings.alertType?t="success":"warning"===this._settings.alertType&&(t="warning"),this._settings.animate&&(t+=" animate"),'<div id="'+this._settings.alertId+'" class="app-alert alert alert-'+t+' alert-dismissible " role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="app-alert-message">'+a+'</div><div class="progress"><div class="progress-bar progress-bar-'+t+' hide" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%"></div></div></div>'}(a)),function(){if(this._settings.duration&&this._settings.showProgressBar){var a="#"+this._settings.alertId,t=n(a).find(".progress-bar");t.removeClass("hide").width(0);var e="width "+this._settings.duration+"ms ease";t.css({WebkitTransition:e,MozTransition:e,MsTransition:e,OTransition:e,transition:e}),setTimeout(function(){0<n(a).length&&n(a).remove()},this._settings.duration)}}()):console.log("appAlert: container must be an html selector!")}var t},window.appAlert=a(window.jQuery)}(),function(){var a;a=function(n){return o={show:function(a){var t=n("#app-loader");if(this._settings=function(a){if(!a)a={};return this._settings=n.extend({},o.options,a)}(a),!t.length){var e=n(this._settings.container);e.length?e.append('<div id="app-loader" class="app-loader" style="z-index:'+this._settings.zIndex+";"+this._settings.css+'"><div class="loading"></div></div>'):console.log("appLoader: container must be an html selector!")}},hide:function(){var a=n("#app-loader");a.length&&a.remove()},options:{container:"body",zIndex:"auto",css:""}};var o},window.appLoader=a(window.jQuery)}(),function(){var a;a=function(o){return s={init:function(a){this._settings=function(a){a=a||{};return this._settings=o.extend({},appLoader.options,a)}(a),function(a){var t="<div class='app-modal-sidebar hidden-xs'>                                        <div class='app-modal-close'><span>&times;</span></div>                                        <div class='app-moadl-sidebar-scrollbar'>                                            <div class='app-modal-sidebar-area'>                                            </div>                                        </div>                                    </div>",e="<i class='fa fa-expand expand hidden-xs'></i>";!1!==a.sidebar&&!isMobile()||(t="",e="<div class='app-modal-close app-modal-fixed-close-button'><span>&times;</span></div>");var n="<div class='app-modal loading'>                                <i class='fa fa-compress compress'></i>                                <div class='app-modal-body'>                                    <div class='app-modal-content'>"+e+"<div class='hide app-modal-close'><span>&times;</span></div>                                        <div class='app-modal-content-area'>                                        </div>                                    </div>"+t+"</div>                            </div>";i(),o("body").prepend(n),setTimeout(function(){var a=o(window).height()-60;o(".app-modal-content-area").prop("scrollHeight")>a&&o(".app-modal-content-area").css({"max-height":a+"px","overflow-y":"scroll"}),o.fn.mCustomScrollbar&&o(".app-moadl-sidebar-scrollbar").mCustomScrollbar({setHeight:a,theme:"minimal-dark",autoExpandScrollbar:!0})},200),o(".expand").click(function(){o(".app-modal").addClass("full-content")}),o(".compress").click(function(){o(".app-modal").removeClass("full-content")}),o(".app-modal-close").click(function(){i()}),o(document).bind("keyup",r),appLoader.show({container:".app-modal",css:"top:35%; right:48%;"}),appModalXhr=o.ajax({url:a.url||"",data:{},cache:!1,type:"POST",success:function(a){var t=o(a);o(".app-modal-content-area").html(t.find(".app-modal-content").html()),o(".app-modal-sidebar-area").html(t.find(".app-modal-sidebar").html()),t.remove(),o(".app-modal").removeClass("loading"),appLoader.hide()},statusCode:{404:function(){s.destroy(),appAlert.error("404: Page not found.")}},error:function(){s.destroy(),appAlert.error("500: Internal Server Error.")}})}(this._settings)},destroy:i,options:{url:"",css:"",sidebar:!0}};function r(a){27===a.keyCode&&i()}function i(){o(".app-modal").remove(),o(document).unbind("keyup",r),"undefined"!=typeof appModalXhr&&appModalXhr.abort()}var s},window.appContentModal=a(window.jQuery)}(),function(c){c.fn.appDateRange=function(a){var d=c.extend({},{dateRangeType:"yearly",filterParams:{},onChange:function(a){},onInit:function(a){}},a);d._inputDateFormat="YYYY-MM-DD",this.each(function(){var a=c(this);a.append('<div class="ml15"><button data-act="prev" class="btn btn-default date-range-selector"><i class="fa fa-chevron-left"></i></button><button data-act="datepicker" class="btn btn-default" style="margin: -1px"></button><button data-act="next"  class="btn btn-default date-range-selector"><i class="fa fa-chevron-right"></i></button></div>');var s=a.find("[data-act='datepicker']"),t=a.find(".date-range-selector");if("yearly"===d.dateRangeType){function n(a){a.html(moment(d.filterParams.start_date).format("YYYY"))}n(s),s.datepicker({format:"YYYY-MM",viewMode:"years",minViewMode:"years",autoclose:!0,language:"custom"}).on("changeDate",function(a){var t=moment(a.date).format(d._inputDateFormat),e=moment(t).format("YYYY");d.filterParams.start_date=e+"-01-01",d.filterParams.end_date=e+"-12-31",d.filterParams.year=e,n(s),d.onChange(d.filterParams)});var e=moment().format("YYYY");d.filterParams.start_date=e+"-01-01",d.filterParams.end_date=e+"-12-31",d.filterParams.year=e,d.onInit(d.filterParams),t.click(function(){var a=c(this).attr("data-act"),t=moment(d.filterParams.start_date),e=moment(d.filterParams.end_date);"next"===a?(t=t.add(1,"years").format(d._inputDateFormat),e=e.add(1,"years").format(d._inputDateFormat)):"prev"===a&&(t=t.subtract(1,"years").format(d._inputDateFormat),e=e.subtract(1,"years").format(d._inputDateFormat)),d.filterParams.start_date=t,d.filterParams.end_date=e,d.filterParams.year=moment(t).format("YYYY"),n(s),d.onChange(d.filterParams)})}else if("monthly"===d.dateRangeType){function l(a){a.html(moment(d.filterParams.start_date).format("MMMM YYYY"))}l(s),s.datepicker({format:"YYYY-MM",viewMode:"months",minViewMode:"months",autoclose:!0,language:"custom"}).on("changeDate",function(a){var t=moment(a.date).format(d._inputDateFormat),e=moment(t).daysInMonth(),n=moment(t).format("YYYY-MM");d.filterParams.start_date=n+"-01",d.filterParams.end_date=n+"-"+e,l(s),d.onChange(d.filterParams)});e=moment().format("YYYY-MM");d.filterParams.start_date=e+"-01",d.filterParams.end_date=e+"-31",d.filterParams.year=e,d.onInit(d.filterParams),t.click(function(){var a=c(this).attr("data-act"),t=moment(d.filterParams.start_date),e=moment(d.filterParams.end_date);if("next"===a){var n=t.add(1,"months"),o=n.daysInMonth();t=(r=n.format("YYYY-MM"))+"-01",e=r+"-"+o}else if("prev"===a){var r,i=t.subtract(1,"months");o=i.daysInMonth();t=(r=i.format("YYYY-MM"))+"-01",e=r+"-"+o}d.filterParams.start_date=t,d.filterParams.end_date=e,d.filterParams.year=moment(t).format("YYYY-MM"),l(s),d.onChange(d.filterParams)})}})}}(jQuery);var loadFilterView=function(t){t.source&&t.targetSelector&&$.ajax({url:t.source,data:t.filterParams,cache:!1,type:"POST",success:function(a){$(t.targetSelector).html(a),appLoader.hide()},statusCode:{404:function(){appLoader.hide(),appAlert.error("404: Page not found.",{container:".modal-body",animate:!1})}},error:function(){appLoader.hide(),appAlert.error("500: Internal Server Error.",{container:".modal-body",animate:!1})}})};!function(s){s.fn.appFilters=function(a){appLoader.show();var t={source:"",targetSelector:"",reloadSelector:"",dateRangeType:"",checkBoxes:[],multiSelect:[],radioButtons:[],filterDropdown:[],singleDatepicker:[],rangeDatepicker:[],isMobile:window.outerWidth<800,filterParams:{customFilter:!0},search:{show:!1},customLanguage:{searchPlaceholder:AppLanugage.search,today:AppLanugage.today,yesterday:AppLanugage.yesterday,tomorrow:AppLanugage.tomorrow},beforeRelaodCallback:function(){},afterRelaodCallback:function(){},onInitComplete:function(){}},e=s(this),n=e;n.append("<div class='custom-toolbar'></div>");var o=s.extend({},t,a);if(o.reload){var r=s(this),i=window.InstanceCollection[r.selector];return r.data("beforeRelaodCallback")&&r.data("beforeRelaodCallback")(r,i.filterParams),loadFilterView(i),r.data("afterRelaodCallback")&&r.data("afterRelaodCallback")(r,i.filterParams),!1}o._firstDayOfWeek=AppHelper.settings.firstDayOfWeek||0,o._inputDateFormat="YYYY-MM-DD",o=prepareDefaultFilters(o),buildFilterDom(o,n,e),window.InstanceCollection=window.InstanceCollection||{},(window.InstanceCollection[e.selector]=o).onInitComplete&&o.onInitComplete(e,o.filterParams),loadFilterView(o),e.data("beforeRelaodCallback",o.beforeRelaodCallback),e.data("afterRelaodCallback",o.afterRelaodCallback)}}(jQuery),replaceAllString=function(a,t,e){return a.split(t).join(e)},toCurrency=function(a,t){a="0"==AppHelper.settings.noOfDecimals?Math.round(parseFloat(a))+".00":parseFloat(a).toFixed(2),t=t||AppHelper.settings.currencySymbol;var e=a.replace(/(\d)(?=(\d{3})+\.)/g,"$1,");return" "===AppHelper.settings.thousandSeparator&&(e=e.replace(","," ")),","===AppHelper.settings.decimalSeparator&&(e=replaceAllString(e,".","_"),e=replaceAllString(e,",","."),e=replaceAllString(e,"_",",")),"none"===t&&(t=""),"0"==AppHelper.settings.noOfDecimals&&(e=e.slice(0,-3)),"right"===AppHelper.settings.currencyPosition?e+""+t:"0"==e.indexOf("-")?"-"+t+(e=e.replace("-","")):t+""+e},calculateDatatableTotal=function(a,t,o,e){var n={};return e&&(n={page:"current"}),a.api().column(t,n).data().reduce(function(a,t,e,n){return o?a+o(t):a+t},0)},unformatCurrency=function(a){return(a=a.toString())&&(0!=(a=a.replace(/[^0-9.,-]/g,"")).indexOf(".")&&0!=a.indexOf(",")||(a=a.slice(1)),a=+(a=","===AppHelper.settings.decimalSeparator?(a=replaceAllString(a,".",""),replaceAllString(a,",",".")):replaceAllString(a,",",""))),a||0},secondsToTimeFormat=function(a){var t=parseInt(a,10),e=Math.floor(t/3600),n=Math.floor((t-3600*e)/60),o=t-3600*e-60*n;return e<10&&(e="0"+e),n<10&&(n="0"+n),o<10&&(o="0"+o),e+":"+n+":"+o},clearAppTableState=function(a){a&&setTimeout(function(){a.api().state.clear()},200)},showHideAppTableColumn=function(a,t,e){a.fnSetColumnVis(t,!!e)},function(n){n.fn.appMention=function(a){var t=n.extend({},{at:"@",dataType:"json",source:"",data:{}},a),e=this;n.ajax({url:t.source,data:t.data,dataType:t.dataType,method:"POST",success:function(a){a.success&&n(e).atwho({at:t.at,data:a.data,insertTpl:"${content}"})}})}}(jQuery),function(e){e.fn.appMultiSelect=function(a){var r=e.extend({},{text:"",options:[],onChange:function(a){},onInit:function(a){}},a);this.each(function(){var a=e(this),n="",o=[];e.each(r.options,function(a,t){var e="";t.isChecked&&(e=" active",o.push(t.id)),n+='<li class="list-group-item clickable '+e+'" data-name="'+r.name+'" data-value="'+t.id+'">',n+=t.text,n+="</li>"}),n="<ul class='list-group dropdown-menu' data-act='multiselect'>"+n+"</ul>";var t='<div class="mr15 DTTT_container custom-toolbar"><span class="dropdown inline-block filter-multi-select"><button class="btn btn-default dropdown-toggle " type="button" data-toggle="dropdown" aria-expanded="true">'+r.text+' <span class="caret"></span> </button>'+n+"</span></div>";a.append(t),r.onInit(o),a.find("[data-name='"+r.name+"']").click(function(){var t=e(this);return t.toggleClass("active"),setTimeout(function(){var a=[];t.parent().find("li").each(function(){e(this).hasClass("active")&&a.push(e(this).attr("data-value"))}),r.onChange(a)}),!1})})}}(jQuery);